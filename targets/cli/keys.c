/**
 * \addtogroup IHM
 * @{
 */

/**
 * \file
 * Fonctions de gestion du clavier
 * \author Anthony RABINE <anthony.rabine@chauvin-arnoux.com>
 */

/*--------------------------------------------------------------------------
|Copyright(C) 2006 ENERDIS
----------------------------------------------------------------------------
|Projet/Logiciel  :  N0075/ENERIUM50
|Responsable      :  J. OGIS
----------------------------------------------------------------------------
|Fichier          :  keys.c
|Chemin d'acces   :
|Auteur           :
|Module           :
|Date de creation :  17/07/2006
|version          :
|Description      :
|
----------------------------------------------------------------------------
|                            H I S T O R I Q U E
----------------------------------------------------------------------------
|Version                : $Revision: 1.1 $
|Auteur                 : $Author: anthony $
|Date de modification   : $Date: 2007-01-02 08:37:52 $
|Nature de la (des) modification(s)  :
|
--------------------------------------------------------------------------*/


/*--------------------------------------------------------------------------
             IMPORTATION DES FICHIERS DE DEFINITION DU PROJET
--------------------------------------------------------------------------*/
#include "keys.h"
#include <io.h>

/*--------------------------------------------------------------------------
                     PROTOTYPE DES FONCTIONS INTERNES
--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------
                              VARIABLES GLOBALES
--------------------------------------------------------------------------*/

#define KEYS_CURRENT ((~io16_get(HGPIODAT1))&0x1F)

static uint16 keys_curr, keys_prev;

/*==========================================================================
======================  I N T E R R U P T I O N S  =========================
==========================================================================*/

/*==========================================================================
==========================  F O N C T I O N S  =============================
==========================================================================*/
/*--------------------------------------------------------------------------
 * Fonction    :  keys_init
 *------------------------------------------------------------------------*/
/** \brief Initialise les variables locales de la gestion du clavier
 *
 * \param -
 *
 * \retval -
 *
 * \remarks -
 *
 * \see -
 */
/*------------------------------------------------------------------------*/
void keys_init(void)
{
   keys_curr = 0;
   keys_prev = 0;
}


/*--------------------------------------------------------------------------
 * Fonction    :  get_key_held
 *------------------------------------------------------------------------*/
/** \brief Retourne l'état des touches restées appuyées
 *
 * \param -
 *
 * \retval -
 *
 * \remarks -
 *
 * \see -
 */
/*------------------------------------------------------------------------*/
uint16 get_key_held(void)
{
   return ( keys_curr &  keys_prev);
}


/*--------------------------------------------------------------------------
 * Fonction    :  get_key_hit
 *------------------------------------------------------------------------*/
/** \brief Retourne les nouvelles touches appuyées
 *
 * \param -
 *
 * \retval -
 *
 * \remarks -
 *
 * \see -
 */
/*------------------------------------------------------------------------*/
uint16 get_key_hit(void)
{
   return ( keys_curr &~ keys_prev);
}


/*--------------------------------------------------------------------------
 * Fonction    :  get_key_released
 *------------------------------------------------------------------------*/
/** \brief Retourne les touches relachées
 *
 * \param -
 *
 * \retval -
 *
 * \remarks -
 *
 * \see -
 */
/*------------------------------------------------------------------------*/
uint16 get_key_released(void)
{
   return (~keys_curr &  keys_prev);
}


/*--------------------------------------------------------------------------
 * Fonction    :  scan_keys
 *------------------------------------------------------------------------*/
/** \brief Lit les informations du clavier
 *
 * \param -
 *
 * \retval -
 *
 * \remarks Ensuite, utiliser les autres fonctions pour connaître les 
 *          touches appuyées
 *
 * \see -
 */
/*------------------------------------------------------------------------*/
void scan_keys(void)
{
   keys_prev = keys_curr;
   keys_curr = KEYS_CURRENT;
}


/*--------------------------------------------------------------------------
                              FIN FICHIER
--------------------------------------------------------------------------*/
/** @} */

